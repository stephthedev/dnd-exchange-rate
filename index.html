---
layout: default
---

<div class="container">
    <div class="row mt-2">
        <div class="col-lg-6 mb-2">
            <form class="form-horizontal" onsubmit="return calculate();" onkeyup="return calculate();">
                <div class="form-group mr-1">
                    <label for="id">Copper</label>
                    <input class="form-control" type="tel" id="cp" name="cp"></input>
                </div>

                <div class="form-group">
                    <label for="sp">Silver</label>
                    <input class="form-control" type="tel" id="sp" name="sp"></input>
                </div>

                <div class="form-group">
                    <label for="ep">Electrum</label>
                    <input class="form-control" type="tel" id="ep" name="ep"></input>
                </div>

                <div class="form-group">
                    <label for="gp">Gold</label>
                    <input class="form-control" type="tel" id="gp" name="gp"></input>
                </div>

                <div class="form-group">
                    <label for="pp">Platinum</label>
                    <input class="form-control" type="tel" id="pp" name="pp"></input>
                </div>

                <div class="form-group">
                    <label for="partySize">Team Size</label>
                    <input class="form-control" type="tel" id="partySize" name="partySize"></input>
                </div>
                
                <div class="form-check">
                    <label class="form-check-label">
                        <input class="form-check-input" type="checkbox" id="csgCoins" name="csgCoins" checked=true></input>
                        Exchange only for copper, silver, and gold
                    </label> 
                </div>

                <button class="btn btn-primary" type="submit">Submit</button>
            </form>
        </div>

        <div class="col-lg-6 align-self-center">
            <div id="result" class="alert alert-info invisible">
                <h5>Results</h5>
                <span id="placeholder"></span>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-md-12">
            {% include instructions.html %}
        </div>
    </div>

    <div class="row">
        <div class="col-md-12">
            {% include rates.html %}
        </div>
    </div>

    <script type="text/javascript">
        function toInteger(number, defaultValue) {
            return !isNaN(number) ? parseInt(number) : defaultValue;
        }

        function toCoinStr(results) {
            var str = "";
            for (var key in results) {
                if (results[key] > 0) {
                    str = str.concat(results[key] + key + " ");
                }
            }
            return str;
        }

        function calculate() {
            //1. Get the coin values from the form
            var coins = {
                cp: document.getElementById("cp").value,
                sp: document.getElementById("sp").value,
                ep: document.getElementById("ep").value,
                gp: document.getElementById("gp").value,
                pp: document.getElementById("pp").value
            }   
            var partySize = toInteger(document.getElementById("partySize").value, -1);
            var coinOpts = document.getElementById("csgCoins").checked ? ["cp", "sp", "gp"] : [];

            var result = "";
            if (partySize > -1) {
                var results = ExchangeRate.teamSplit(partySize, coins, coinOpts);
                result = "<ul>"
                for (var i=0; i<results.length; i++) {
                    result = result.concat("<li>", toCoinStr(results[i]), "</li>");
                }
                result = result.concat("</ul>");
            } else {
                //2. Get the optimal results
                var results = ExchangeRate.optimalExchange(coins, coinOpts);

                //3. Create a human-readable string showcasing the results
                result = result.concat(toCoinStr(results));
            }

            //Unhide the result
            var resultDiv = document.getElementById("result");
            resultDiv.classList.remove("invisible");

            var placeholder = document.getElementById("placeholder");
            placeholder.innerHTML = result;
            return false;
        }
    </script>
</div>